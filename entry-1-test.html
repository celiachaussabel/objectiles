<!DOCTYPE html>
<html lang="en">

<head>
  <title>Hallway Interactive</title>
  <link rel="stylesheet" href="1-src/main.css">
  <link rel="stylesheet" href="1-src/popup.css">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="1-src/fade.js"></script>
  <script src="1-src/popup.js"></script>
  <script src="1-src/layout.js"></script>
  <script src="1-src/video.js"></script>
  <style>
    .container {
      background: url('hallway/bgd-hallway.png') 100% 100%;
    }
  </style>
</head>

<body>

  <script>
    // showIntroVideo('entry-1/animation-entry-1.2.mp4', 1000, false, false, true, false);


    // BACKGROUND MUSIC
    var music = new Audio('0-music/compdata-r0.mp3');
    music.loop = true;
    let musicStarted = false;

    function startMusic() {
      if (!musicStarted) {
        music.play();
        musicStarted = true;
        console.log('Music started');
      }
    }

    // Global click handler using capture phase
    // This will catch ALL clicks on the page, even in popups that use stopPropagation()
    document.addEventListener('click', function (e) {
      startMusic();
      console.log('Click detected (capture phase)');
    }, true); // true = use capture phase


  </script>

  <div class="container">

    <!-- an example of a video popup and an animation + button hide that runs when the popup dismisses, u -->
    <img id="pushstick-btn" src="hallway/button-pushstick.png" class="button"
      style="top: 785px; left: 350px; width: 160px; height: auto;" onclick="popup.showVideo({
        videos: 'entry-1/animation-entry-1.2.mp4',
        name: 'pushstick-test',
        fullscreen: true,
        tintBackground: false,
        takeOverScreen: true,
        fade: true,
        onDismiss: function() {
          var btn = document.getElementById('pushstick-btn');
          if (!btn) return;
          btn.style.transition = 'none';
          btn.style.transform = 'translateX(0)';
          let shakes = 0;
          let shakeInterval = setInterval(function() {
            btn.style.transform = 'translateX(' + (shakes % 2 === 0 ? '-16px' : '16px') + ')';
            shakes++;
            if (shakes > 7) {
              clearInterval(shakeInterval);
              btn.style.transition = 'transform 2s, opacity 0.4s';
              btn.style.transform = 'translateX(0)';
              btn.style.opacity = '0';
              btn.addEventListener('transitionend', function handler() {
                btn.style.display = 'none';
                btn.removeEventListener('transitionend', handler);
              });
            }
          }, 40);
        }
      })">

    <!--
<img src="hallway/button-pushstick.png" class="button" style="top: 785px; left: 350px; width: 160px; height: auto;"
      onclick="popup.showImage({
        images: 'hallway/animation-pushstick.gif',
        name: 'pushstick',
        fullscreen: true,
        tintBackground: false,
        takeOverScreen: true,
        fade: true
      })">
-->

    <img src="hallway/button-stair.png" class="button" style="top: 825px; left: 840px; width: 395px; height: auto;"
      onclick="popup.showImage({
        images: 'hallway/animation-pushstick-3.gif',
        name: 'stair',
        fullscreen: true,
        tintBackground: false,
        takeOverScreen: true,
        fade: true
      })">

    <img src="all/button-back.png" class="button" style="top: 950px; left: 50px; width: 100px; height: auto;"
      onclick="fadeToScene('character.html')">

    <img src="all/button-next.png" class="button" style="top: 950px; left: 1750px; width: 100px; height: auto;"
      onclick="fadeToScene('livingroom-interactive.html')">

  </div>



</body>

</html>